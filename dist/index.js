"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _react=_interopRequireWildcard(require("react"));var _propTypes=require("prop-types");function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};var ownKeys=Object.keys(source);if(typeof Object.getOwnPropertySymbols==="function"){ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable}))}ownKeys.forEach(function(key){_defineProperty(target,key,source[key])})}return target}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true})}else{obj[key]=value}return obj}function _extends(){_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};return _extends.apply(this,arguments)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}return _assertThisInitialized(self)}function _getPrototypeOf(o){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)};return _getPrototypeOf(o)}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:true,configurable:true}});if(superClass)_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){o.__proto__=p;return o};return _setPrototypeOf(o,p)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}var styles={inlineEdit:{textDecoration:"underline dotted",cursor:"pointer"},inputWrapper:{position:"relative"},inputWrapperInput:{width:"100%",margin:0,padding:".5rem"},inputWrapperActions:{position:"absolute",width:"100%",display:"flex",color:"white"},inputWrapperActionsButton:{flex:"0 0 50%",border:"none",padding:".5rem",color:"white",textTransform:"uppercase"}};var getValueByType=function getValueByType(value,type){if(type==="number"){try{var _number=Number(value);if(Number.isNaN(_number)){return null}return _number}catch(e){return value}}return value};var getFormatedValue=function getFormatedValue(value,format){if(!format){return value}return format(value)};var InlineEdit=function(_PureComponent){_inherits(InlineEdit,_PureComponent);function InlineEdit(props){var _this;_classCallCheck(this,InlineEdit);_this=_possibleConstructorReturn(this,_getPrototypeOf(InlineEdit).call(this,props));var _this$props=_this.props,value=_this$props.value,type=_this$props.type;var valueToUse=getValueByType(value,type);_this.state={value:valueToUse,edit:false};_this.toggleMode=_this.toggleMode.bind(_assertThisInitialized(_assertThisInitialized(_this)));_this.cancel=_this.cancel.bind(_assertThisInitialized(_assertThisInitialized(_this)));_this.save=_this.save.bind(_assertThisInitialized(_assertThisInitialized(_this)));_this.change=_this.change.bind(_assertThisInitialized(_assertThisInitialized(_this)));_this.handleKeyDown=_this.handleKeyDown.bind(_assertThisInitialized(_assertThisInitialized(_this)));_this.inputRef=_react.default.createRef();return _this}_createClass(InlineEdit,[{key:"handleKeyDown",value:function handleKeyDown(ev){if(ev.key==="Enter"){this.save();return}if(ev.key==="Escape"){this.cancel();return}}},{key:"componentDidUpdate",value:function componentDidUpdate(){var _this$props2=this.props,updateOnNewProps=_this$props2.updateOnNewProps,value=_this$props2.value;var edit=this.state.edit;if(!updateOnNewProps){return}if(edit){return}this.setState({value:value})}},{key:"toggleMode",value:function toggleMode(edit){var _this2=this;this.setState({edit:edit},function(){if(edit&&_this2.inputRef&&_this2.inputRef.current){_this2.inputRef.current.focus()}})}},{key:"save",value:function save(){var _this3=this;this.setState({edit:false},function(){return _this3.props.onSave(_this3.state.value)})}},{key:"cancel",value:function cancel(){this.setState({edit:false,value:this.props.value})}},{key:"change",value:function change(ev){var type=this.props.type;this.setState({value:getValueByType(ev.target.value,type)})}},{key:"render",value:function render(){var _this4=this;var _this$props3=this.props,tag=_this$props3.tag,type=_this$props3.type,format=_this$props3.format,minDate=_this$props3.minDate,maxDate=_this$props3.maxDate;var value=this.state.value;var Tag=tag;var Input=type==="textarea"?"textarea":"input";var additionalProps={};if(type==="date"){additionalProps.min=minDate;additionalProps.max=maxDate}return _react.default.createElement("div",{className:"inline-edit",style:styles.inlineEdit},this.state.edit?_react.default.createElement("div",{className:"input-wrapper",style:styles.inputWrapper},_react.default.createElement(Input,_extends({onKeyDownCapture:this.handleKeyDown,ref:this.inputRef,style:styles.inputWrapperInput,type:this.props.type,value:this.state.value,onChange:this.change},additionalProps)),_react.default.createElement("div",{className:"actions",style:styles.inputWrapperActions},_react.default.createElement("button",{style:_objectSpread({},styles.inputWrapperActionsButton,{backgroundColor:this.props.saveColor}),className:"save",onClick:this.save},this.props.saveLabel),_react.default.createElement("button",{style:_objectSpread({},styles.inputWrapperActionsButton,{backgroundColor:this.props.cancelColor}),className:"cancel",onClick:this.cancel},this.props.cancelLabel))):_react.default.createElement(Tag,{className:"tag-wrapper",onClick:function onClick(){return _this4.toggleMode(true)}},getFormatedValue(value,format)))}}]);return InlineEdit}(_react.PureComponent);InlineEdit.propTypes={value:(0,_propTypes.oneOfType)([_propTypes.string,_propTypes.number]),format:_propTypes.func,tag:_propTypes.string,type:_propTypes.string,onSave:_propTypes.func,updateOnNewProps:_propTypes.bool,saveColor:_propTypes.string,saveLabel:_propTypes.string,cancelColor:_propTypes.string,cancelLabel:_propTypes.string,getValue:_propTypes.func};InlineEdit.defaultProps={value:"",format:null,tag:"span",type:"text",onSave:null,updateOnNewProps:false,saveColor:"blue",saveLabel:"Save",cancelColor:"red",cancelLabel:"Cancel",getValue:null,minDate:"",maxDate:""};var _default=InlineEdit;exports.default=_default;

//# sourceMappingURL=index.js.map